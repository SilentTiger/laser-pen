# ç®€ä»‹

Laser Pen æ˜¯ä¸€å¥—ç”¨æ¥åœ¨ web canvas ä¸Šç»˜åˆ¶é¼ æ ‡å°¾è¿¹çš„å·¥å…·é›†ã€‚

ä¼—æ‰€å‘¨çŸ¥ï¼Œäº§å“ç»ç†çš„éœ€æ±‚å¾€å¾€åƒå¥‡ç™¾æ€ªå¤©é©¬è¡Œç©ºï¼Œæ‰€ä»¥ Laser Pen å¹¶ä¸ä»…ä»…æ˜¯æä¾›ä¸€ä¸ªç»˜åˆ¶é¼ æ ‡å°¾è¿¹çš„æ–¹æ³•ï¼ŒåŒæ—¶ä¹Ÿå°†å†…éƒ¨çš„å„ç§å·¥å…·æ–¹æ³•æš´éœ²å‡ºæ¥ï¼Œæ–¹ä¾¿å¼€å‘åŒå­¦èƒ½åœ¨æ­¤å·¥å…·é›†çš„åŸºç¡€ä¸Šå®ç°å„ç§ç‰¹æ®Šéœ€æ±‚ï¼Œå‡å°‘è„±å‘ã€‚

# ç¤ºä¾‹

[åœ¨çº¿æ¼”ç¤º](https://silenttiger.github.io/laser-pen/)

# å¦‚ä½•ä½¿ç”¨

é¦–å…ˆåœ¨ä½ çš„é¡¹ç›®ä¸­æ·»åŠ å¯¹ Laser Pen çš„ä¾èµ–ï¼š

```bash
yarn add laser-pen
```

ç„¶åç›‘å¬é¼ æ ‡çš„ move äº‹ä»¶ï¼Œè·å–é¼ æ ‡ç§»åŠ¨è½¨è¿¹çš„åæ ‡ï¼Œå¹¶åŒæ—¶è®°å½• move äº‹ä»¶è§¦å‘æ—¶çš„æ—¶é—´æˆ³ã€‚

```javascript
// è·å– canvas å…ƒç´ çš„åæ ‡
const canvasPos = document.querySelector('canvas').getBoundingClientRect()
// ç”¨æ¥å­˜å‚¨æ‰€æœ‰é¼ æ ‡è½¨è¿¹æ•°æ®
let mouseTrack = []
// ç›‘å¬é¼ æ ‡äº‹ä»¶
document.addEventListener('mousemove', (event) => {
  mouseTrack.push({
    x: event.clientX - canvasPos.x,
    y: event.clientY - canvasPos.y,
    time: Date.now(),
  })
})
```

æœ€ååœ¨éœ€è¦çš„æ—¶å€™è°ƒç”¨ Laser Pen çš„æ–¹æ³•ç»˜åˆ¶é¼ æ ‡å°¾è¿¹

```javascript
import { drainPoints, drawLaserPen } from 'laser-pen'

function draw(ctx) {
  mouseTrack = drainPoints(mouseTrack)
  if (mouseTrack.length < 3) {
    return
  }
  drawLaserPen(ctx, mouseTrack)
}
```

å¼ºçƒˆå»ºè®®é€šè¿‡ requestAnimationFrame æ¥ç®¡ç†åŠ¨ç”»å¸§ã€‚å…·ä½“ç”¨æ³•å¯å‚è€ƒä»£ç ä»“åº“ä¸­ example ç›®å½•ä¸‹çš„ä»£ç ã€‚

# è¯¦ç»†è¯´æ˜

## åŠ¨æœº

ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ä¸ªé¡¹ç›®ï¼Ÿåœ¨å…¬å¸çš„æŸæ¬¡å‘¨ä¼šä¸Šï¼Œæˆ‘åæ§½äº†æŸäº§å“ä¸­ä¸€ä¸ªæ˜¾ç¤ºé¼ æ ‡å°¾è¿¹çš„æ•ˆæœå®ç°å¾—æ¯”è¾ƒæŠ½è±¡ï¼Œå½“æ—¶æˆ‘è§‰å¾—è¿™ä¹ˆç®€å•ä¸€ä¸ªæ•ˆæœå®Œå…¨åº”è¯¥åšçš„å®Œå–„ä¸€ç‚¹ï¼Œä¹ŸèŠ±ä¸äº†å¤šå°‘æ—¶é—´ã€‚

ç´§æ¥ç€çš„ä¸€ä¸ªå‘¨æœ«çš„ä¸­åˆï¼Œæˆ‘æ­£åœ¨æ´—ç¢—ï¼Œçªç„¶è„‘å­é‡Œçµå…‰ä¸€é—ªï¼Œæˆ‘æ„è¯†åˆ°ï¼Œåœ¨ web canvas ä¸Šè¦å®ç°ä¸€ä¸ªã€Œå®Œç¾ã€çš„é¼ æ ‡å°¾è¿¹æ•ˆæœä¼¼ä¹å¹¶æ²¡æœ‰æˆ‘åœ¨å‘¨ä¼šä¸Šæƒ³è±¡çš„é‚£ä¹ˆç®€å•ã€‚äºæ˜¯æˆ‘å†³å®šè‡ªå·±å°è¯•ä¸€ä¸‹ï¼Œå°±æœ‰äº†è¿™ä¸ªé¡¹ç›®ã€‚

## é—®é¢˜

æ‰€è°“æ²¡æœ‰æƒ³è±¡çš„é‚£ä¹ˆç®€å•ï¼Œä¸»è¦æ˜¯æœ‰ä¸€ä¸‹å‡ ä¸ªæ–¹é¢çš„é—®é¢˜ã€‚

- é€šè¿‡é¼ æ ‡ç§»åŠ¨çš„äº‹ä»¶è·å–çš„é¼ æ ‡è½¨è¿¹æ˜¯ç¦»æ•£çš„ç‚¹åæ ‡ï¼Œè€Œä¸æ˜¯çœŸå®çš„å°¾è¿¹æ›²çº¿ï¼Œå¦‚ä½•é€šè¿‡ç¦»æ•£åæ ‡æ‹Ÿåˆå‡ºä¸€ä¸ªå¹³æ»‘æ›²çº¿ï¼Ÿ
- é¼ æ ‡å°¾è¿¹çš„é€æ˜åº¦åº”è¯¥æ˜¯æ¸å˜çš„ï¼Œweb canvas ä¸Šå¹¶æ²¡æœ‰æä¾›åœ¨ä¸€ä¸ª path ä¸Šåšçº¿æ€§æ¸å˜çš„æ¥å£ï¼Œè¿™ä¸ªæ•ˆæœå¦‚ä½•å®ç°ï¼Ÿ
- é¼ æ ‡å°¾è¿¹çš„ç²—ç»†ä¹Ÿåº”è¯¥æ˜¯æ¸å˜çš„ï¼Œweb canvas ä¸Šçš„å•ä¸€ path ä¹Ÿæ²¡æœ‰æä¾›ç”»ç¬”ç²—ç»†æ¸å˜çš„æ¥å£ï¼Œè¿™ä¸ªæ•ˆæœåˆå¦‚ä½•å®ç°ï¼Ÿ

## åŸç†

### å¦‚ä½•é€šè¿‡ç¦»æ•£åæ ‡ç‚¹æ‹Ÿåˆå‡ºå¹³æ»‘æ›²çº¿ï¼Ÿ

å¦‚æœä½ ç”¨è¿‡ Photoshop ä¸­çš„é’¢ç¬”å·¥å…·ï¼Œç­”æ¡ˆå…¶å®å°±å¾ˆç®€å•ï¼Œç”¨è´å¡å°”æ›²çº¿ã€‚Photoshop ä¸­çš„é’¢ç¬”å·¥å…·å…¶å®å°±æ˜¯ä¸€ä¸ªè´å¡å°”æ›²çº¿ç¼–è¾‘å™¨ï¼Œé€šè¿‡èµ·ç‚¹ã€ç»ˆç‚¹ä»¥åŠä¸¤ä¸ªæ§åˆ¶ç‚¹ï¼Œå°±å¯ä»¥åœ¨èµ·ç‚¹å’Œç»ˆç‚¹é—´å»ºç«‹ä¸€æ¡æ›²çº¿ã€‚

![photoshop pen](./docs/assets/pen.png)

è€Œå¦‚æœä¸€ä¸ªä¸­é—´ç‚¹ä¸Šçš„ä¸¤ä¸ªæ§åˆ¶ç‚¹æ»¡è¶³ä¸€å®šçš„è§„å¾‹ï¼Œå°±å¯ä»¥å®ç°æ›²çº¿çš„è¿ç»­ï¼Œä¹Ÿå°±æ˜¯è§†è§‰æ•ˆæœä¸Šçš„å¹³æ»‘ã€‚æ„Ÿå…´è¶£çš„è¯å¯ä»¥é˜…è¯»ã€Œ[ç”¨é’¢ç¬”å·¥å…·ç»˜å›¾](https://helpx.adobe.com/cn/photoshop/using/drawing-pen-tools.html)ã€ä¸­çš„å†…å®¹ã€‚

é‚£ä¹ˆä¸­é—´ç‚¹ä¸Šçš„ä¸¤ä¸ªæ§åˆ¶ç‚¹æ»¡è¶³ä»€ä¹ˆæ ·çš„è§„å¾‹å°±å¯ä»¥å®ç°æ›²çº¿çš„è¿ç»­å‘¢ï¼Ÿå…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯ä¸­é—´ç‚¹å’Œä¸¤ä¸ªæ§åˆ¶ç‚¹åœ¨åŒä¸€ç›´çº¿ä¸Šå³å¯ã€‚

### å¦‚ä½•å®ç°çº¿å®½å’Œé€æ˜åº¦çš„æ¸å˜

## æ€§èƒ½

![flame chart](./docs/assets/performance_1.png)
ä»ä¸Šé¢çš„ç«ç„°å›¾å¯ä»¥çœ‹å‡ºï¼ŒæŒç»­ç»˜åˆ¶é¼ æ ‡å°¾è¿¹çš„æ€§èƒ½è¿˜æ˜¯æ¯”è¾ƒä¸é”™çš„ï¼Œå¸§ç‡å§‹ç»ˆéƒ½ä½ç½®åœ¨ 60fps å·¦å³ã€‚

![flame chart](./docs/assets/performance_2.png)
æ¯ä¸€æ¬¡ç»˜åˆ¶çš„æ—¶é—´ä¹ŸåŸºæœ¬ä¸Šä¸åˆ° 0.5msã€‚

æ ¹æ®ä¸ªäººä»¥å¾€çš„ç»éªŒï¼Œç±»ä¼¼ Laser Pen è¿™æ ·å®Œå…¨ä¸ä¾èµ– DOM å’Œ BOM çš„ JavaScript åº“å¾€å¾€éƒ½æœ‰ç€ä¸é”™çš„æ€§èƒ½æŒ‡æ ‡ã€‚JavaScript åœ¨çº¯æ•°å­¦å’Œé€»è¾‘å¤„ç†ä¸Šæ•ˆç‡è¿˜æ˜¯å¾ˆé«˜çš„ã€‚

## æ€»ç»“

æ²¡äº‹å¤šæ´—æ´—ç¢—ã€‚è¯´ä¸å®šå°±ä¼šæœ‰æ„å¤–çš„æ”¶è· ğŸ˜‚

# License

MIT
